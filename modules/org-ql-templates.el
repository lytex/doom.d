;;; org-ql-templates.el -*- lexical-binding: t; -*-

(setq load-path '("/home/julian/.emacs.d/.local/straight/build-28.1/org-edna" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-org-ql" "/home/julian/.emacs.d/.local/straight/build-28.1/kv" "/home/julian/.emacs.d/.local/straight/build-28.1/esxml" "/home/julian/.emacs.d/.local/straight/build-28.1/peg" "/home/julian/.emacs.d/.local/straight/build-28.1/ov" "/home/julian/.emacs.d/.local/straight/build-28.1/ts" "/home/julian/.emacs.d/.local/straight/build-28.1/org-super-agenda" "/home/julian/.emacs.d/.local/straight/build-28.1/map" "/home/julian/.emacs.d/.local/straight/build-28.1/log4e" "/home/julian/.emacs.d/.local/straight/build-28.1/gntp" "/home/julian/.emacs.d/.local/straight/build-28.1/alert" "/home/julian/.emacs.d/.local/straight/build-28.1/websocket" "/home/julian/.emacs.d/.local/straight/build-28.1/simple-httpd" "/home/julian/.emacs.d/.local/straight/build-28.1/package-lint" "/home/julian/.emacs.d/.local/straight/build-28.1/tablist" "/home/julian/.emacs.d/.local/straight/build-28.1/yaml" "/home/julian/.emacs.d/.local/straight/build-28.1/emacsql" "/home/julian/.emacs.d/.local/straight/build-28.1/emacsql-sqlite" "/home/julian/.emacs.d/.local/straight/build-28.1/forge" "/home/julian/.emacs.d/.local/straight/build-28.1/deferred" "/home/julian/.emacs.d/.local/straight/build-28.1/uuidgen" "/home/julian/.emacs.d/.local/straight/build-28.1/treepy" "/home/julian/.emacs.d/.local/straight/build-28.1/ghub" "/home/julian/.emacs.d/.local/straight/build-28.1/a" "/home/julian/.emacs.d/.local/straight/build-28.1/closql" "/home/julian/.emacs.d/.local/straight/build-28.1/magit-popup" "/home/julian/.emacs.d/.local/straight/build-28.1/magit-section" "/home/julian/.emacs.d/.local/straight/build-28.1/epl" "/home/julian/.emacs.d/.local/straight/build-28.1/pkg-info" "/home/julian/.emacs.d/.local/straight/build-28.1/with-editor" "/home/julian/.emacs.d/.local/straight/build-28.1/transient" "/home/julian/.emacs.d/.local/straight/build-28.1/compat" "/home/julian/.emacs.d/.local/straight/build-28.1/annalist" "/home/julian/.emacs.d/.local/straight/build-28.1/expand-region" "/home/julian/.emacs.d/.local/straight/build-28.1/embrace" "/home/julian/.emacs.d/.local/straight/build-28.1/fringe-helper" "/home/julian/.emacs.d/.local/straight/build-28.1/git-gutter" "/home/julian/.emacs.d/.local/straight/build-28.1/ucs-utils" "/home/julian/.emacs.d/.local/straight/build-28.1/list-utils" "/home/julian/.emacs.d/.local/straight/build-28.1/pcache" "/home/julian/.emacs.d/.local/straight/build-28.1/persistent-soft" "/home/julian/.emacs.d/.local/straight/build-28.1/font-utils" "/home/julian/.emacs.d/.local/straight/build-28.1/goto-chg" "/home/julian/.emacs.d/.local/straight/build-28.1/shrink-path" "/home/julian/.emacs.d/.local/straight/build-28.1/ht" "/home/julian/.emacs.d/.local/straight/build-28.1/lv" "/home/julian/.emacs.d/.local/straight/build-28.1/hydra" "/home/julian/.emacs.d/.local/straight/build-28.1/popup" "/home/julian/.emacs.d/.local/straight/build-28.1/async" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-core" "/home/julian/.emacs.d/.local/straight/build-28.1/xref" "/home/julian/.emacs.d/.local/straight/build-28.1/elisp-refs" "/home/julian/.emacs.d/.local/straight/build-28.1/f" "/home/julian/.emacs.d/.local/straight/build-28.1/s" "/home/julian/.emacs.d/.local/straight/build-28.1/dash" "/home/julian/.emacs.d/.local/straight/build-28.1/parent-mode" "/home/julian/.emacs.d/.local/straight/build-28.1/bind-key" "/home/julian/.emacs.d/.local/straight/build-28.1/benchmark-init" "/home/julian/.emacs.d/.local/straight/build-28.1/habitica" "/home/julian/.emacs.d/.local/straight/build-28.1/org-graph-edna" "/home/julian/.emacs.d/.local/straight/build-28.1/org-linker-edna" "/home/julian/.emacs.d/.local/straight/build-28.1/org-linker" "/home/julian/.emacs.d/.local/straight/build-28.1/ob-go" "/home/julian/.emacs.d/.local/straight/build-28.1/vimrc-mode" "/home/julian/.emacs.d/.local/straight/build-28.1/activity-watch-mode" "/home/julian/.emacs.d/.local/straight/build-28.1/org-caldav" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-quickscope" "/home/julian/.emacs.d/.local/straight/build-28.1/beacon" "/home/julian/.emacs.d/.local/straight/build-28.1/fzf" "/home/julian/.emacs.d/.local/straight/build-28.1/org-web-tools" "/home/julian/.emacs.d/.local/straight/build-28.1/org-noter-pdftools" "/home/julian/.emacs.d/.local/straight/build-28.1/nov" "/home/julian/.emacs.d/.local/straight/build-28.1/pdf-view-restore" "/home/julian/.emacs.d/.local/straight/build-28.1/pdf-continuous-scroll-mode" "/home/julian/.emacs.d/.local/straight/build-28.1/org-tree-slide" "/home/julian/.emacs.d/.local/straight/build-28.1/org-sticky-header" "/home/julian/.emacs.d/.local/straight/build-28.1/origami" "/home/julian/.emacs.d/.local/straight/build-28.1/org-ql" "/home/julian/.emacs.d/.local/straight/build-28.1/org-modern" "/home/julian/.emacs.d/.local/straight/build-28.1/org-wild-notifier" "/home/julian/.emacs.d/.local/straight/build-28.1/org-roam-ui" "/home/julian/.emacs.d/.local/straight/build-28.1/org-remark" "/home/julian/.emacs.d/.local/straight/build-28.1/org-transclusion" "/home/julian/.emacs.d/.local/straight/build-28.1/link-hint" "/home/julian/.emacs.d/.local/straight/build-28.1/drag-stuff" "/home/julian/.emacs.d/.local/straight/build-28.1/yaml-mode" "/home/julian/.emacs.d/.local/straight/build-28.1/company-shell" "/home/julian/.emacs.d/.local/straight/build-28.1/ob-async" "/home/julian/.emacs.d/.local/straight/build-28.1/org-roam" "/home/julian/.emacs.d/.local/straight/build-28.1/org-noter" "/home/julian/.emacs.d/.local/straight/build-28.1/org-journal" "/home/julian/.emacs.d/.local/straight/build-28.1/orgit" "/home/julian/.emacs.d/.local/straight/build-28.1/org-pdftools" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-org" "/home/julian/.emacs.d/.local/straight/build-28.1/org-cliplink" "/home/julian/.emacs.d/.local/straight/build-28.1/toc-org" "/home/julian/.emacs.d/.local/straight/build-28.1/ox-clip" "/home/julian/.emacs.d/.local/straight/build-28.1/org-yt" "/home/julian/.emacs.d/.local/straight/build-28.1/htmlize" "/home/julian/.emacs.d/.local/straight/build-28.1/avy" "/home/julian/.emacs.d/.local/straight/build-28.1/org-contrib" "/home/julian/.emacs.d/.local/straight/build-28.1/org" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-markdown" "/home/julian/.emacs.d/.local/straight/build-28.1/edit-indirect" "/home/julian/.emacs.d/.local/straight/build-28.1/markdown-toc" "/home/julian/.emacs.d/.local/straight/build-28.1/markdown-mode" "/home/julian/.emacs.d/.local/straight/build-28.1/buttercup" "/home/julian/.emacs.d/.local/straight/build-28.1/flycheck-cask" "/home/julian/.emacs.d/.local/straight/build-28.1/flycheck-package" "/home/julian/.emacs.d/.local/straight/build-28.1/elisp-demos" "/home/julian/.emacs.d/.local/straight/build-28.1/elisp-def" "/home/julian/.emacs.d/.local/straight/build-28.1/overseer" "/home/julian/.emacs.d/.local/straight/build-28.1/macrostep" "/home/julian/.emacs.d/.local/straight/build-28.1/highlight-quoted" "/home/julian/.emacs.d/.local/straight/build-28.1/saveplace-pdf-view" "/home/julian/.emacs.d/.local/straight/build-28.1/pdf-tools" "/home/julian/.emacs.d/.local/straight/build-28.1/code-review" "/home/julian/.emacs.d/.local/straight/build-28.1/magit-todos" "/home/julian/.emacs.d/.local/straight/build-28.1/magit-gitflow" "/home/julian/.emacs.d/.local/straight/build-28.1/magit" "/home/julian/.emacs.d/.local/straight/build-28.1/request" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-xref" "/home/julian/.emacs.d/.local/straight/build-28.1/ivy-xref" "/home/julian/.emacs.d/.local/straight/build-28.1/dumb-jump" "/home/julian/.emacs.d/.local/straight/build-28.1/eros" "/home/julian/.emacs.d/.local/straight/build-28.1/quickrun" "/home/julian/.emacs.d/.local/straight/build-28.1/flycheck-popup-tip" "/home/julian/.emacs.d/.local/straight/build-28.1/flycheck" "/home/julian/.emacs.d/.local/straight/build-28.1/git-modes" "/home/julian/.emacs.d/.local/straight/build-28.1/git-timemachine" "/home/julian/.emacs.d/.local/straight/build-28.1/git-commit" "/home/julian/.emacs.d/.local/straight/build-28.1/browse-at-remote" "/home/julian/.emacs.d/.local/straight/build-28.1/undo-fu-session" "/home/julian/.emacs.d/.local/straight/build-28.1/undo-fu" "/home/julian/.emacs.d/.local/straight/build-28.1/fd-dired" "/home/julian/.emacs.d/.local/straight/build-28.1/dired-rsync" "/home/julian/.emacs.d/.local/straight/build-28.1/diff-hl" "/home/julian/.emacs.d/.local/straight/build-28.1/dired-git-info" "/home/julian/.emacs.d/.local/straight/build-28.1/diredfl" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-vimish-fold" "/home/julian/.emacs.d/.local/straight/build-28.1/vimish-fold" "/home/julian/.emacs.d/.local/straight/build-28.1/yasnippet" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-collection" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-quick-diff" "/home/julian/.emacs.d/.local/straight/build-28.1/exato" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-visualstar" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-traces" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-textobj-anyblock" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-surround" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-snipe" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-numbers" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-nerd-commenter" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-lion" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-indent-plus" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-exchange" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-escape" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-embrace" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-easymotion" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-args" "/home/julian/.emacs.d/.local/straight/build-28.1/evil" "/home/julian/.emacs.d/.local/straight/build-28.1/persp-mode" "/home/julian/.emacs.d/.local/straight/build-28.1/vi-tilde-fringe" "/home/julian/.emacs.d/.local/straight/build-28.1/git-gutter-fringe" "/home/julian/.emacs.d/.local/straight/build-28.1/unicode-fonts" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-goggles" "/home/julian/.emacs.d/.local/straight/build-28.1/neotree" "/home/julian/.emacs.d/.local/straight/build-28.1/nav-flash" "/home/julian/.emacs.d/.local/straight/build-28.1/evil-anzu" "/home/julian/.emacs.d/.local/straight/build-28.1/anzu" "/home/julian/.emacs.d/.local/straight/build-28.1/doom-modeline" "/home/julian/.emacs.d/.local/straight/build-28.1/highlight-indent-guides" "/home/julian/.emacs.d/.local/straight/build-28.1/hl-todo" "/home/julian/.emacs.d/.local/straight/build-28.1/emojify" "/home/julian/.emacs.d/.local/straight/build-28.1/solaire-mode" "/home/julian/.emacs.d/.local/straight/build-28.1/doom-themes" "/home/julian/.emacs.d/.local/straight/build-28.1/wgrep" "/home/julian/.emacs.d/.local/straight/build-28.1/ivy-rich" "/home/julian/.emacs.d/.local/straight/build-28.1/counsel-projectile" "/home/julian/.emacs.d/.local/straight/build-28.1/amx" "/home/julian/.emacs.d/.local/straight/build-28.1/counsel" "/home/julian/.emacs.d/.local/straight/build-28.1/ivy-avy" "/home/julian/.emacs.d/.local/straight/build-28.1/ivy-hydra" "/home/julian/.emacs.d/.local/straight/build-28.1/ivy" "/home/julian/.emacs.d/.local/straight/build-28.1/swiper" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-descbinds" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-org" "/home/julian/.emacs.d/.local/straight/build-28.1/swiper-helm" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-projectile" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-describe-modes" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-company" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-c-yasnippet" "/home/julian/.emacs.d/.local/straight/build-28.1/helm-rg" "/home/julian/.emacs.d/.local/straight/build-28.1/helm" "/home/julian/.emacs.d/.local/straight/build-28.1/company-dict" "/home/julian/.emacs.d/.local/straight/build-28.1/company" "/home/julian/.emacs.d/.local/straight/build-28.1/which-key" "/home/julian/.emacs.d/.local/straight/build-28.1/general" "/home/julian/.emacs.d/.local/straight/build-28.1/project" "/home/julian/.emacs.d/.local/straight/build-28.1/projectile" "/home/julian/.emacs.d/.local/straight/build-28.1/ws-butler" "/home/julian/.emacs.d/.local/straight/build-28.1/smartparens" "/home/julian/.emacs.d/.local/straight/build-28.1/pcre2el" "/home/julian/.emacs.d/.local/straight/build-28.1/helpful" "/home/julian/.emacs.d/.local/straight/build-28.1/dtrt-indent" "/home/julian/.emacs.d/.local/straight/build-28.1/better-jumper" "/home/julian/.emacs.d/.local/straight/build-28.1/restart-emacs" "/home/julian/.emacs.d/.local/straight/build-28.1/rainbow-delimiters" "/home/julian/.emacs.d/.local/straight/build-28.1/highlight-numbers" "/home/julian/.emacs.d/.local/straight/build-28.1/hide-mode-line" "/home/julian/.emacs.d/.local/straight/build-28.1/all-the-icons" "/home/julian/.emacs.d/.local/straight/build-28.1/use-package" "/home/julian/.emacs.d/.local/straight/build-28.1/straight" "/home/julian/.emacs.d/.local/straight/build-28.1/explain-pause-mode" "/home/julian/.emacs.d/.local/straight/build-28.1/gcmh" "/home/julian/.emacs.d/.local/straight/build-28.1/auto-minor-mode" "/home/julian/.emacs.d/.local/straight/repos/use-package" "/home/julian/.emacs.d/.local/straight/repos/straight.el" "/home/julian/.emacs.d/core/" "/snap/emacs/current/usr/share/emacs/28.1/site-lisp" "/snap/emacs/current/usr/share/emacs/site-lisp" "/snap/emacs/current/usr/share/emacs/28.1/lisp" "/snap/emacs/current/usr/share/emacs/28.1/lisp/vc" "/snap/emacs/current/usr/share/emacs/28.1/lisp/url" "/snap/emacs/current/usr/share/emacs/28.1/lisp/textmodes" "/snap/emacs/current/usr/share/emacs/28.1/lisp/progmodes" "/snap/emacs/current/usr/share/emacs/28.1/lisp/play" "/snap/emacs/current/usr/share/emacs/28.1/lisp/org" "/snap/emacs/current/usr/share/emacs/28.1/lisp/nxml" "/snap/emacs/current/usr/share/emacs/28.1/lisp/net" "/snap/emacs/current/usr/share/emacs/28.1/lisp/mh-e" "/snap/emacs/current/usr/share/emacs/28.1/lisp/mail" "/snap/emacs/current/usr/share/emacs/28.1/lisp/leim" "/snap/emacs/current/usr/share/emacs/28.1/lisp/language" "/snap/emacs/current/usr/share/emacs/28.1/lisp/international" "/snap/emacs/current/usr/share/emacs/28.1/lisp/image" "/snap/emacs/current/usr/share/emacs/28.1/lisp/gnus" "/snap/emacs/current/usr/share/emacs/28.1/lisp/eshell" "/snap/emacs/current/usr/share/emacs/28.1/lisp/erc" "/snap/emacs/current/usr/share/emacs/28.1/lisp/emulation" "/snap/emacs/current/usr/share/emacs/28.1/lisp/emacs-lisp" "/snap/emacs/current/usr/share/emacs/28.1/lisp/cedet" "/snap/emacs/current/usr/share/emacs/28.1/lisp/calendar" "/snap/emacs/current/usr/share/emacs/28.1/lisp/calc" "/snap/emacs/current/usr/share/emacs/28.1/lisp/obsolete" "/snap/emacs/current/usr/share/emacs/28.1/lisp/vc" "/snap/emacs/current/usr/share/emacs/28.1/lisp/url" "/snap/emacs/current/usr/share/emacs/28.1/lisp/textmodes" "/snap/emacs/current/usr/share/emacs/28.1/lisp/progmodes" "/snap/emacs/current/usr/share/emacs/28.1/lisp/play" "/snap/emacs/current/usr/share/emacs/28.1/lisp/org" "/snap/emacs/current/usr/share/emacs/28.1/lisp/nxml" "/snap/emacs/current/usr/share/emacs/28.1/lisp/net" "/snap/emacs/current/usr/share/emacs/28.1/lisp/mh-e" "/snap/emacs/current/usr/share/emacs/28.1/lisp/mail" "/snap/emacs/current/usr/share/emacs/28.1/lisp/leim" "/snap/emacs/current/usr/share/emacs/28.1/lisp/language" "/snap/emacs/current/usr/share/emacs/28.1/lisp/international" "/snap/emacs/current/usr/share/emacs/28.1/lisp/image" "/snap/emacs/current/usr/share/emacs/28.1/lisp/gnus" "/snap/emacs/current/usr/share/emacs/28.1/lisp/eshell" "/snap/emacs/current/usr/share/emacs/28.1/lisp/erc" "/snap/emacs/current/usr/share/emacs/28.1/lisp/emulation" "/snap/emacs/current/usr/share/emacs/28.1/lisp/emacs-lisp" "/snap/emacs/current/usr/share/emacs/28.1/lisp/cedet" "/snap/emacs/current/usr/share/emacs/28.1/lisp/calendar" "/snap/emacs/current/usr/share/emacs/28.1/lisp/calc" "/snap/emacs/current/usr/share/emacs/28.1/lisp/obsolete"))

(require 'org-ql)
(require 'org)


;; Get all headlines that have :template:
(defun lytex/get-org-templates ()

    (org-ql-query :select
        '(cons (substring-no-properties (org-get-heading)) (org-id-get-create))
        :from
        (org-agenda-files)
        :where
        '(ltags "template")))

(defun lytex/set-org-templates (org-templates)

(setq keyboard-list "jkl;asdfghuiopqwertynm,.zxcvbJKL:ASDFGHUIOPQWERTYNM<>ZXCVB1234567890-=!@#$%^&*()_+[]'/{}?")
(setq iterating-list (substring keyboard-list 0 (length org-templates)))

(setq org-capture-templates (append org-capture-templates (mapcar* #'(lambda (key template)
  (setq id  (cdr template))
`(,(concat "t" (make-string 1 key)) ,(car template) plain
  (file "Inbox.org")
  (function ,(lytex/get-template-by-id id))
   :unnarrowed t))
      iterating-list org-templates))))


;; https://stackoverflow.com/questions/2321904/elisp-how-to-save-data-in-a-file
(defun print-to-file (filename data)
    (with-temp-file filename
      (prin1 data (current-buffer))))

(defun read-from-file (filename)
  (with-temp-buffer
    (insert-file-contents filename)
    (cl-assert (eq (point) (point-min)))
    (read (current-buffer))))



;; (use-package! async)
;; (async-start

;;         (lambda ()
;;                 (load "/home/julian/.doom.d/modules/org-ql-templates.el")
;;                 (lytex/get-org-templates))

;;         (lambda (org-templates)
;;                 (load "/home/julian/.doom.d/modules/org-ql-templates.el")
;;                 (setq org-capture-templates (lytex/set-org-templates org-templates))))
